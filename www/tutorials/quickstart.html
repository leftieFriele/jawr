<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">










<html>
  <head>
    <title>Jawr - Tutorial: quick setup</title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
      </head>
  <body class="composite">
    <!-- TODO: move this into JavaScript to patch the skin
      <div class="xright">  </div>
    -->
    <div id="leftColumn">
      <div id="navcolumn">
             <dl class=navgroup>
        <dt>About</dt>
        <dd><ul>
              
    <li class="none">
              <a href="../servlets/ProjectHome">Home</a>
        </li>
              
    <li class="none">
              <a href="../introduction.html">Introduction</a>
        </li>
          </ul></dd>
    </dl>
      <dl class=navgroup>
        <dt>Documentation</dt>
        <dd><ul>
              
    <li class="none">
              <a href="../docs/servlet.html">The Jawr servlet</a>
        </li>
              
    <li class="none">
              <a href="../docs/descriptor_syntax.html">Descriptor syntax</a>
        </li>
              
    <li class="none">
              <a href="../docs/custom_bundles.html">Bundle definition</a>
        </li>
              
    <li class="none">
              <a href="../docs/source_ordering.html">Source order in bundles</a>
        </li>
              
    <li class="none">
              <a href="../docs/postprocessors.html">Postprocessors</a>
        </li>
              
    <li class="none">
              <a href="../docs/license_files.html">Licenses in resources</a>
        </li>
              
    <li class="none">
              <a href="../docs/taglibs.html">Tag libraries</a>
        </li>
              
    <li class="none">
              <a href="../docs/modes.html">Debug and production modes</a>
        </li>
          </ul></dd>
    </dl>
      <dl class=navgroup>
        <dt>Tutorials</dt>
        <dd><ul>
              
    <li class="none">
              <strong>Quick start</strong>
        </li>
              
    <li class="none">
              <a href="../tutorials/libraries.html">Using popular libraries</a>
        </li>
          </ul></dd>
    </dl>
      <dl class=navgroup>
        <dt>Project tools</dt>
        <dd><ul>
              
    <li class="none">
              <a href="../servlets/ProjectHome">Project home</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectMemberList">Membership</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectNewsList">Announcements</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectForumView">Discussion forums</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectMailingListList">Mailing lists</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectDocumentList">Documents & files</a>
        </li>
              
    <li class="none">
              <a href="../source/browse/jawr/">Subversion</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectIssues">Issue tracker</a>
        </li>
          </ul></dd>
    </dl>
      <dl class=navgroup>
        <dt>Project Documentation</dt>
        <dd><ul>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
              <a href="../project-info.html">Project Information</a>
              </li>
              
                
              
      
            
      
              
        <li class="collapsed">
              <a href="../project-reports.html">Project Reports</a>
              </li>
          </ul></dd>
    </dl>
        </div>
      <script>
        // replace the java.net project tools with the navigation bar from Maven.
        // also get rid of "Get Involved" thingie too, while we are at it
        var pt = document.getElementById("projecttools");
        var nv = document.getElementById("navcolumn");
        
        while(pt.previousSibling!=null)
          pt.parentNode.removeChild(pt.previousSibling);
        
        pt.parentNode.insertBefore(nv,pt);
        pt.parentNode.removeChild(pt);
      </script>
      <script>
        // kill "description" h3 bar
        var ld = document.getElementById("longdescription");
        if(ld!=null) {
          for( n=ld.firstChild; n!=null; n=n.nextSibling ) {
            if(n.nodeType==1 && n.innerHTML=="Description" ) {
              n.parentNode.removeChild(n);
              break;
            }
          }
        }
      </script>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Quick Jawr setup</h2><div class="section"><h3>Download and install</h3><p><a href="https://jawr.dev.java.net/servlets/ProjectDocumentList?folderID=8543">Download Jawr from the documents area</a> and place it within the classpath of your application (typically, under WEB-INF/lib). Add log4j.jar to the path as well. </p><p>If you are using java 1.4, you can optionally download <a href="http://backport-jsr166.sourceforge.net/">backport-util-concurrent</a> and add it to the classpath as well for improved performance. This is <b>not</b> needed the JDK version of your server is 5 or higher. </p><p>Alternatively, if you are using Maven 2, add a dependency to Jawr in your POM file: </p><div class="source"><pre>        &lt;dependency&gt;
          &lt;groupId&gt;net.jawr&lt;/groupId&gt;
          &lt;artifactId&gt;jawr&lt;/artifactId&gt;
          &lt;version&gt;1.1&lt;/version&gt;
        &lt;/dependency&gt;</pre></div><p>Also, if you are using Maven 2 make sure your project will access the Maven repository at java.net, by specifying it in you POM: </p><div class="source"><pre>  &lt;repositories&gt;
        &lt;repository&gt;
          &lt;id&gt;maven2-repository.dev.java.net&lt;/id&gt;
          &lt;name&gt;Java.net Repository for Maven&lt;/name&gt;
          &lt;url&gt;http://download.java.net/maven/2/&lt;/url&gt;
          &lt;layout&gt;default&lt;/layout&gt;
        &lt;/repository&gt;
  &lt;/repositories&gt;</pre></div></div><div class="section"><h3>Develop your scripts and stylesheets</h3><p>For the quick setup, it is assumed that you have the following directories at the root of your application: <b>/js</b>, <b>/js/lib</b> and <b>/css</b>. Of course these may contain more subdirs. The sample configuration will create a bundle containing everything under <b>/js/lib</b>, named <b>/bundles/lib.js</b>. The remaining .js files at /js and subdirs will be served separately. As for the CSS files, a single all-in-one bundle named <b>/bundles/all.css</b> will be used. </p></div><div class="section"><h3>Configure instances of the Jawr Servlet</h3><p>Add <b>net.jawr.web.servlet.JawrServlet</b> to your web.xml descriptor. You will need an instance for handling Javascript, and another one for CSS stylesheets. For instance: </p><div class="source"><pre>        &lt;servlet&gt;
                &lt;servlet-name&gt;JavascriptServlet&lt;/servlet-name&gt;
                &lt;servlet-class&gt;net.jawr.web.servlet.JawrServlet&lt;/servlet-class&gt;
                &lt;init-param&gt;
                        &lt;param-name&gt;configLocation&lt;/param-name&gt;
                        &lt;param-value&gt;/jawr.properties&lt;/param-value&gt;
                &lt;/init-param&gt;
                &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
        &lt;/servlet&gt;
        
        &lt;servlet&gt;
                &lt;servlet-name&gt;CSSServlet&lt;/servlet-name&gt;
                &lt;servlet-class&gt;net.jawr.web.servlet.JawrServlet&lt;/servlet-class&gt;
                &lt;init-param&gt;
                        &lt;param-name&gt;configLocation&lt;/param-name&gt;
                        &lt;param-value&gt;/jawr.properties&lt;/param-value&gt;
                &lt;/init-param&gt;
                &lt;init-param&gt;
                        &lt;param-name&gt;type&lt;/param-name&gt;
                        &lt;param-value&gt;css&lt;/param-value&gt;
                &lt;/init-param&gt;
                &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
        &lt;/servlet&gt;
        
        ...
        
        &lt;servlet-mapping&gt;
                &lt;servlet-name&gt;JavascriptServlet&lt;/servlet-name&gt;
                &lt;url-pattern&gt;*.js&lt;/url-pattern&gt;
        &lt;/servlet-mapping&gt; 
        
        &lt;servlet-mapping&gt;
                &lt;servlet-name&gt;CSSServlet&lt;/servlet-name&gt;
                &lt;url-pattern&gt;*.css&lt;/url-pattern&gt;
        &lt;/servlet-mapping&gt; </pre></div><p>This is all the configuration required to get the Jawr servlet up and running. </p></div><div class="section"><h3>Create the Jawr configuration file</h3><p>Now you need to create the jawr.properties descriptor file. This file should be in the application classpath in runtime, for example at the WEB-INF/classes dir. Add this content to the file: </p><div class="source"><pre># Common properties
jawr.debug.on=false
jawr.gzip.on=true
jawr.gzip.ie6.on=false
jawr.charset.name=UTF-8

# Javascript properties and mappings
jawr.js.bundle.basedir=/js
jawr.js.commonURLPrefix=003

# Javascript properties and mappings
jawr.js.bundle.names=lib

# All files within /js/lib will be together in a bundle. 
# The remaining scripts will be served sepparately. 
jawr.js.bundle.lib.id=/bundles/lib.js
jawr.js.bundle.lib.global=true
jawr.js.bundle.lib.mappings=/js/lib/**
jawr.js.bundle.lib.prefix=lib001


# CSS properties and mappings
jawr.css.bundle.basedir=/css
jawr.css.commonURLPrefix=css004

# CSS files will be all bundled together automatically
jawr.js.factory.use.singlebundle=true
jawr.js.factory.singlebundle.bundlename=/bundles/all.css</pre></div></div><div class="section"><h3>Create the Log4j configuration file</h3><p>In order to see output log messages, you need to create a log4j configuration file. For this setup, we will use a properties file which should be in the application classpath (alongside the jwr.properties file). The file should be named log4j.properties and the contents be as follows: </p><div class="source"><pre># Set root logger level to DEBUG and its only appender to A1.
log4j.rootLogger=INFO, A1

# A1 is set to be a ConsoleAppender.
log4j.appender.A1=org.apache.log4j.ConsoleAppender

# A1 uses PatternLayout.
log4j.appender.A1.layout=org.apache.log4j.PatternLayout
log4j.appender.A1.layout.ConversionPattern=%-4r [%t] %-5p %c %x - %m%n

# Print messages up to level DEBUG
log4j.logger.net.jawr=INFO</pre></div><p>Note that the log level is set to INFO. The DEBUG level would ouput verbose log messages, and you should use it only if you experience problems with your configuration. This file will setup log4j to log only to the system console. Please refer to the log4j documentation for different setup options. </p></div><div class="section"><h3>Test the bundles</h3><p>Create a test javascript file at the <b>/js</b> directory, named <b>test.js</b>. Then write JSP page and add the following content: </p><div class="source"><pre>&lt;%@ taglib uri=&quot;http://jawr.java.net/tags&quot; prefix=&quot;jwr&quot; %&gt;
&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; %&gt;
&lt;html&gt;
&lt;head&gt;
&lt;jwr:style src=&quot;/bundles/all.css&quot; /&gt;
&lt;jwr:script src=&quot;/js/test.js&quot;/&gt; 
&lt;/head&gt;
&lt;body&gt;
        ...
&lt;/body&gt;
&lt;/html&gt;
</pre></div><p>Deploy your application to a server and open the JSP you created. The page should contain a link to css004/bundles/all.css, a script tag pointing at lib001/bundles/lib.js and another one pointing at 003/js/test.js. If you visited the page with Firefox, the URl might be prefixed by 'gzip_'. If you open these files from the browser, you will find they have been minified. </p><p>Finally, change the jawr.debug.on property in the descriptor file to <b>true</b> and redeploy the application. Visit the page again and you will see how each file is imported separately. If you have used an exploded deployment directory instead of a WAR archived file, you can now change any of the script or css files and see the changes inmediately by refreshing the page. </p></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2008
    
          
  

  
  
  &nbsp;| Last Published: 02/01/2008
  &nbsp;| Version: 1.2
</div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
