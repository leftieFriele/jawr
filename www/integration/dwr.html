<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">










<html>
  <head>
    <title>Jawr - DWR integration</title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
      </head>
  <body class="composite">
    <!-- TODO: move this into JavaScript to patch the skin
      <div class="xright">  </div>
    -->
    <div id="leftColumn">
      <div id="navcolumn">
             <dl class=navgroup>
        <dt>About</dt>
        <dd><ul>
              
    <li class="none">
              <a href="../servlets/ProjectHome">Home</a>
        </li>
              
    <li class="none">
              <a href="../introduction.html">Introduction</a>
        </li>
          </ul></dd>
    </dl>
      <dl class=navgroup>
        <dt>Documentation</dt>
        <dd><ul>
              
    <li class="none">
              <a href="../docs/servlet.html">The Jawr servlet</a>
        </li>
              
    <li class="none">
              <a href="../docs/descriptor_syntax.html">Descriptor syntax</a>
        </li>
              
    <li class="none">
              <a href="../docs/custom_bundles.html">Bundle definition</a>
        </li>
              
    <li class="none">
              <a href="../docs/source_ordering.html">Source order in bundles</a>
        </li>
              
    <li class="none">
              <a href="../docs/postprocessors.html">Postprocessors</a>
        </li>
              
    <li class="none">
              <a href="../docs/generators.html">Generators</a>
        </li>
              
    <li class="none">
              <a href="../docs/license_files.html">Licenses in resources</a>
        </li>
              
    <li class="none">
              <a href="../docs/taglibs.html">JSP Tag library</a>
        </li>
              
    <li class="none">
              <a href="../docs/plain_html.html">Use in HTML pages</a>
        </li>
              
    <li class="none">
              <a href="../docs/modes.html">Debug and production modes</a>
        </li>
              
    <li class="none">
              <a href="../docs/messages_gen.html">i18n message generator</a>
        </li>
          </ul></dd>
    </dl>
      <dl class=navgroup>
        <dt>Integration</dt>
        <dd><ul>
              
    <li class="none">
              <a href="../integration/augmenter.html">Add Jawr to your framework</a>
        </li>
              
    <li class="none">
              <a href="../integration/facelets.html">Facelets Tag library</a>
        </li>
              
    <li class="none">
              <a href="../integration/grails.html">Grails plugin</a>
        </li>
              
    <li class="none">
              <strong>DWR</strong>
        </li>
              
    <li class="none">
              <a href="../integration/validator.html">Commons Validator - Struts</a>
        </li>
          </ul></dd>
    </dl>
      <dl class=navgroup>
        <dt>Tutorials</dt>
        <dd><ul>
              
    <li class="none">
              <a href="../tutorials/quickstart.html">Quick start</a>
        </li>
              
    <li class="none">
              <a href="../tutorials/faq_howto.html">FAQ-Howto</a>
        </li>
              
    <li class="none">
              <a href="../tutorials/libraries.html">Using popular libraries</a>
        </li>
          </ul></dd>
    </dl>
      <dl class=navgroup>
        <dt>API and sources</dt>
        <dd><ul>
              
    <li class="none">
              <a href="../nonav/apidocs/index.html">JavaDocs</a>
        </li>
              
    <li class="none">
              <a href="../nonav/xref/index.html">Source XREF</a>
        </li>
          </ul></dd>
    </dl>
      <dl class=navgroup>
        <dt>Project tools</dt>
        <dd><ul>
              
    <li class="none">
              <a href="../servlets/ProjectHome">Project home</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectMemberList">Membership</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectNewsList">Announcements</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectForumView">Discussion forums</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectMailingListList">Mailing lists</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectDocumentList">Documents & files</a>
        </li>
              
    <li class="none">
              <a href="../source/browse/jawr/">Subversion</a>
        </li>
              
    <li class="none">
              <a href="../servlets/ProjectIssues">Issue tracker</a>
        </li>
          </ul></dd>
    </dl>
        </div>
      <script>
        // replace the java.net project tools with the navigation bar from Maven.
        // also get rid of "Get Involved" thingie too, while we are at it
        var pt = document.getElementById("projecttools");
        var nv = document.getElementById("navcolumn");
        
        while(pt.previousSibling!=null)
          pt.parentNode.removeChild(pt.previousSibling);
        
        pt.parentNode.insertBefore(nv,pt);
        pt.parentNode.removeChild(pt);
      </script>
      <script>
        // kill "description" h3 bar
        var ld = document.getElementById("longdescription");
        if(ld!=null) {
          for( n=ld.firstChild; n!=null; n=n.nextSibling ) {
            if(n.nodeType==1 && n.innerHTML=="Description" ) {
              n.parentNode.removeChild(n);
              break;
            }
          }
        }
      </script>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Using DWR with Jawr</h2><p><a href="http://getahead.org/dwr/">DWR</a> (Direct Web Remoting) is a java library which allows Javascript in a browser to interact with Java on a server and helps you manipulate web pages with the results. </p><p>DWR works by setting up one or several servlets which serve javascript and also convert AJAX requests to java class method invocations. The javascript served by DWR is either one of several static .js files or a generated javascript stub that allows method calls to be routed to the server via AJAX. </p><p>DWR already has a method to minify and compress javascript, but Jawr adds extra functionality so that you serve your resources more consistently. Specifically, with JAWR you can serve all the static .js files in one bundle. You can also combine these with other scripts. For instance, you could have a javascript bundle containng Prototype.js, script.aculo.us, your own infrastructure and the DWR static scripts. </p><p>Also, you can bundle together the generated javascript stubs which normally must be requested separately. For pages that use several remote objects, this can speed up loading. </p><p>Finally, using this approach you have a consistent way of serving all javascript, instead of using different methods to serve DWR scripts or Jawr bundles. </p><p>Jawr supports DWR 2.x out of the box, and it can also be used with version 3 by adding an additional plugin jar to the classpath. The plugin can be downloaded from <a href="https://jawr.dev.java.net/servlets/ProjectDocumentList?folderID=9382">this page</a>. Maven 2 users can also add a dependency as the following: </p><div class="source"><pre>    &lt;dependency&gt;
      &lt;groupId&gt;net.jawr.dwr&lt;/groupId&gt;
      &lt;artifactId&gt;dwr3plugin&lt;/artifactId&gt;
      &lt;version&gt;1.0&lt;/version&gt;
    &lt;/dependency&gt;</pre></div><p>Currently this plugin is only available for a Java 5 or higher JVM. </p><p>There is a sample application that you can download to chek out how integration with DWR works, which you can download from <a href="https://jawr.dev.java.net/servlets/ProjectDocumentList?folderID=9330">this page</a>. </p><div class="section"><h3>Set up</h3><p>The jawr servlet must be started after the DWR one. To make sure this order is followed, you must set up the <i>load-on-startup</i> parameter so that the value for the Jawr servlet is greater than the one for the DWR servlet: </p><div class="source"><pre>        &lt;servlet&gt;
           &lt;servlet-name&gt;dwr-invoker&lt;/servlet-name&gt;
           &lt;display-name&gt;DWR Servlet&lt;/display-name&gt;
           &lt;description&gt;Direct Web Remoter Servlet&lt;/description&gt;
           &lt;servlet-class&gt;org.directwebremoting.servlet.DwrServlet&lt;/servlet-class&gt;
           ...
           &lt;load-on-startup&gt;1&lt;/load-on-startup&gt; &lt;-- Loads first 
        &lt;/servlet&gt;
  
        &lt;servlet&gt;
                &lt;servlet-name&gt;JavascriptServlet&lt;/servlet-name&gt;
                &lt;servlet-class&gt;net.jawr.web.servlet.JawrServlet&lt;/servlet-class&gt;
           ...
           &lt;load-on-startup&gt;2&lt;/load-on-startup&gt; &lt;-- Loads after DWR
        &lt;/servlet&gt;</pre></div><p>Jawr needs to know the sevlet mapping that points to DWR. Therefore, in the properties config you must set up the <b>jawr.dwr.mapping</b> parameter to the same value (without the wildcard) that you use for the DWR servlet: </p><div class="source"><pre>  Web.xml: 
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;dwr-invoker&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/dwr/*&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;
  
  Jawr.properties:
  jawr.dwr.mapping=/dwr/</pre></div><div class="section"><h4>Additional DWR servlet instances</h4><p>If you declare more than one DWR servlet, Jawr will need to access the additional mappings for these. In this case, for every additional servlet you must add a special init-param, named <b>jawr_mapping</b>. The value, again, must be the servlet-mapping used for the servlet, without the wildcard. Note that this init-param is added to the DWR servlet config, <b>not</b> the Jawr servlet config. </p><div class="source"><pre>   &lt;servlet&gt;
    &lt;servlet-name&gt;additional-dwr-invoker&lt;/servlet-name&gt;
    &lt;display-name&gt;DWR Servlet&lt;/display-name&gt;
    &lt;description&gt;Direct Web Remoter Servlet&lt;/description&gt;
    &lt;servlet-class&gt;org.directwebremoting.servlet.DwrServlet&lt;/servlet-class&gt;
    ...
    &lt;init-param&gt;
            &lt;param-name&gt;jawr_mapping&lt;/param-name&gt;
            &lt;param-value&gt;/other/dwr/&lt;/param-value&gt; &lt;-- Matches servlet-mapping
    &lt;/init-param&gt;
    ...
   &lt;/servlet&gt;
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;additional-dwr-invoker&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/other/dwr/*&lt;/url-pattern&gt; &lt;-- Use in jawr_mapping
  &lt;/servlet-mapping&gt;
   </pre></div><p>You need to do this for additional DWR servlets, but you can skip it for the one to which mapping you point in the <b>jawr.dwr.mapping</b> param. You can't skip using this param though, since it acts as a flag to Jawr indicating that DWR integration is on. </p></div></div><div class="section"><h3>Maping DWR resources in bundles</h3><p>Once you have performed setup, you can start using DWR beans in your bundle mappings. All DWR resources are mapped using the special prefix '<b>dwr:</b>'. As stated before, DWR has several static resources that you will probably want to bundle with the rest of your javascript infrastructure code (Prototype, YUI or whichever, etc). You map to these using several special keywords: </p><table class="bodyTable"><tbody><tr class="a"><td align="left"><b>Keyword</b></td><td align="left"><b>DWR script</b></td></tr><tr class="b"><td align="left">dwr:_engine</td><td align="left">engine.js</td></tr><tr class="a"><td align="left">dwr:_util</td><td align="left">util.js</td></tr><tr class="b"><td align="left">dwr:_auth</td><td align="left">auth.js</td></tr><tr class="a"><td align="left">dwr:_actionutil</td><td align="left">DWRActionUtil.js (webwork integration)</td></tr></tbody></table><p>The engine.js script should always be included first since others depend on it. Note that this file is not completaly static, since DWR generates some variables depending on the user's request. This is not optimal, since users will get a new copy on every new session with the application. Jawr solves this by generating these parameters in a very small inline script that contains only the dynamic variables. </p><p>So in a typical use case, you would be adding these to a global bundle: </p><div class="source"><pre>        jawr.js.bundle.names=global
        
        jawr.js.bundle.global.id=/bundles/global.js
        jawr.js.bundle.global.mappings=/js/protaculous/**, dwr:_engine, dwr:_util
        jawr.js.bundle.global.global=true</pre></div><p>To add DWR beans (the javascript stubs to access java objects in the server), you use the <b>dwr:</b> prefix followed by the name you specified in the dwr.xml config file (or in the alternate configuration method of your choice). </p><p>For instance, the following mapping adds two of these beans to a bundle:</p><div class="source"><pre>    dwr.xml: 
    &lt;create creator=&quot;new&quot; javascript=&quot;People&quot; scope=&quot;script&quot;&gt; &lt;-- Use the value of the 'javascript' attribute
      &lt;param name=&quot;class&quot; value=&quot;org.getahead.dwrdemo.people.People&quot;/&gt;
    &lt;/create&gt;
        &lt;create creator=&quot;new&quot; javascript=&quot;LiveHelp&quot; scope=&quot;application&quot;&gt;
      &lt;param name=&quot;class&quot; value=&quot;org.getahead.dwrdemo.livehelp.LiveHelp&quot;/&gt;
    &lt;/create&gt;
    
    jawr.config:
    jawr.js.bundle.mybundle.mappings=dwr:People, dwr:LiveHelp
        </pre></div><p>Note that Jawr does not support having several DWR servlets that map to beans with the same names. You can't declare two DWR servlets with a bean named 'Person', for instance. </p><p>One last thing you can do is to bundle <b>all</b> dwr beans into one bundle. To do this, tou use the special keyword <b>dwr:_**</b>: </p><div class="source"><pre>   This adds all beans defined in dwr.xml: 
   jawr.js.bundle.alldwrbeans.mappings=_**
        </pre></div><p>Be aware that this mapping does not include the static DWR scripts, only the bean stubs. Here is an example of an all-in-one DWR bundle: </p><div class="source"><pre>        jawr.js.bundle.names=dwrall
        
        jawr.js.bundle.dwrall.id=/bundles/dwrall.js
        jawr.js.bundle.dwrall.mappings=dwr:_engine, dwr:_util,dwr:_auth, dwr:_**        </pre></div></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2008
    
          
  

  
  
  &nbsp;| Last Published: 11/09/2008
  &nbsp;| Version: 2.5.1
</div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
